
service: ai-standup-api
frameworkVersion: '3'

provider:
  name: aws
  runtime: nodejs18.x
  httpApi:
    cors: true
  environment:
    MONGO_URI: ${env:MONGO_URI, 'mongodb://localhost:27017/ai-standup'}
    MYSQL_HOST: ${env:MYSQL_HOST, 'localhost'}
    MYSQL_USER: ${env:MYSQL_USER, 'root'}
    MYSQL_PASSWORD: ${env:MYSQL_PASSWORD, 'password'}
    MYSQL_DB: ${env:MYSQL_DB, 'ai-standup'}
    SUMMARIZER_BASE_URL: http://localhost:${env:SUMMARIZER_PORT, '3002'}

plugins:
  - serverless-dotenv-plugin
  - serverless-offline

custom:
  serverless-offline:
    httpPort: ${env:API_PORT, '3001'}
    lambdaPort: 9001

functions:
  graphql:
    handler: dist/handlers/api.graphql
    events:
      - httpApi:
          path: /graphql
          method: ANY
